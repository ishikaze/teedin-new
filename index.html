<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="style.css">
    <title>Teedin</title>
</head>
<body style="background-color: var(--dark);">
    <div id="splash-screen">
        <div class="splash-center">
            <img src="./assets/img/logo.png" alt="Teedin Logo" class="splash-logo">
            <div class="splash-version">v0.5</div>
        </div>
        <div class="splash-progress-container">
            <div class="splash-progress-bar"><div class="splash-progress"></div></div>
            <div class="splash-loading-text">กำลังโหลดรูปภาพ...</div>
        </div>
    </div>
    
    <div id="featured">
        <div class="featured-slider">
            <img id="featured-image" src="./assets/img/banner-01.jpg" alt="Featured" class="featured-img" />
            <div id="featured-text-container">
                <div id="featured-hero-text" class="featured-hero-text"></div>
                <div id="featured-text" class="featured-text"></div>
                <button id="featured-btn" class="featured-btn" onmousedown="showOverlay(true)">ซื้อ/ขาย</button>
            </div>
            <div id="buySellOverlay">
                <div id="buyOverlay" onmousedown="redirect('./buy')">ซื้อ</div>
                <div id="sellOverlay">ขาย</div>
            </div>
        </div>
    </div>


    <script src="index.js"></script>
    <script src="header_footer.js"></script>
    <script>
    
    const splashScreen = document.getElementById('splash-screen');
    const splashLogo = document.querySelector('.splash-logo');
    const splashVersion = document.querySelector('.splash-version');
    const splashProgress = document.querySelector('.splash-progress');
    const splashLoadingText = document.querySelector('.splash-loading-text');
    const navbar = document.getElementById('navbar');

    // preload list UPDATE IF THERES NEW PICTURE
    const preloadImages = [
        './assets/img/logo.png',
        './assets/img/banner-01.jpg',
        './assets/img/banner-02.jpg',
        './assets/img/banner-03.jpg',
        './assets/img/banner-04.jpg',
        './assets/img/banner-05.jpg',
        './assets/img/property-01.jpg',
        './assets/img/property-02.jpg',
        './assets/img/property-03.jpg',
        './assets/img/property-04.jpg',
        './assets/img/property-05.jpg',
        './assets/img/property-06.jpg',
        './assets/img/property-07.jpg',
        './assets/img/property-08.jpg',
        './assets/img/property-09.jpg',
        './assets/img/img111.jpg',
        './assets/img/img112.jpg',
        './assets/img/img113.jpg',
        './assets/img/featured.jpg',
        './assets/img/deal-01.jpg',
        './assets/img/deal-02.jpg',
        './assets/img/deal-03.jpg',
        './assets/img/contact-bg.jpg',
        './assets/img/page-heading-bg.jpg',
        './assets/img/video-bg.jpg',
        './assets/img/video-frame.jpg'
    ];

    let loadedCount = 0;
    function updateProgress() {
        const percent = Math.round((loadedCount / preloadImages.length) * 100);
        splashProgress.style.width = percent + '%';
        splashLoadingText.textContent = `กำลังโหลดรูปภาพ (${loadedCount}/${preloadImages.length})...`;
    }

    function preloadAllImages(callback) {
        preloadImages.forEach(src => {
            const img = new Image();
            img.onload = img.onerror = function() {
                loadedCount++;
                updateProgress();
                if (loadedCount === preloadImages.length) {
                    callback();
                }
            };
            img.src = src;
        });
    }

    function fadeOutSplash() {
        splashScreen.classList.add('fade-out');
        setTimeout(() => {
            splashScreen.style.display = 'none';
            navbar.style.display = '';
        }, 700);
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Show splash only on first load
        if (!sessionStorage.getItem('splashShown')) {
            splashScreen.style.display = 'flex';
            updateProgress();
            setTimeout(function() {
                preloadAllImages(function() {
                    splashLoadingText.textContent = 'โหลดเสร็จสิ้น!';
                    splashProgress.style.width = '100%';
                    setTimeout(() => {
                        splashProgress.style.opacity = '0';
                        splashLoadingText.style.opacity = '0';
                        setTimeout(function() {
                            fadeOutSplash();
                            sessionStorage.setItem('splashShown', '1');
                        }, 1000);
                    }, 1000);
                });
            }, 2000);
        } else {
            splashScreen.style.display = 'none';
            
            navbar.style.display = '';
        }
    });

    </script>
</body>
</html>